#!/usr/bin/env perl

# Copyright 2007 Red hat, Inc.
# License: LGPL

# Remove any unreferenced images

use strict;
use warnings;

my $cmd
    = q/find . -type f -regex '.*\(svg\|png\|jpg\|jpeg\|gif\)' | grep -v Common_Content | sort/;

foreach my $file (`$cmd`) {
    chomp($file);
    $file =~ /^.*\/([^\/]*)$/;
    my $img = $1;
    if ( $img ne "icon.svg" && `grep -rle '[\/"]$img' *` !~ /./ ) {
        print("Removing unused image: $file\n");
        system("rm -f $file") == 0 || die("Could not remove $file");
    }
}
